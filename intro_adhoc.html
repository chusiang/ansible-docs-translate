

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Introduction To Ad-Hoc Commands &mdash; ansible中文權威指南 1.0.1 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="ansible中文權威指南 1.0.1 documentation" href="index.html"/>
        <link rel="up" title="總體介紹" href="intro.html"/>
        <link rel="next" title="Ansible的配置檔案" href="intro_configuration.html"/>
        <link rel="prev" title="Patterns" href="intro_patterns.html"/> 

  
  <script src="static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> ansible中文權威指南
          

          
          </a>

          
            
            
              <div class="version">
                1.0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="intro.html">總體介紹</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="intro_installation.html">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro_getting_started.html">新手上路</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro_inventory.html">Inventory檔案</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro_dynamic_inventory.html">動態 Inventory</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro_patterns.html">Patterns</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="">Introduction To Ad-Hoc Commands</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#parallelism-and-shell-commands">Parallelism and Shell Commands</a></li>
<li class="toctree-l3"><a class="reference internal" href="#file-transfer">File Transfer</a></li>
<li class="toctree-l3"><a class="reference internal" href="#managing-packages">Managing Packages</a></li>
<li class="toctree-l3"><a class="reference internal" href="#users-and-groups">Users and Groups</a></li>
<li class="toctree-l3"><a class="reference internal" href="#deploying-from-source-control">Deploying From Source Control</a></li>
<li class="toctree-l3"><a class="reference internal" href="#managing-services">Managing Services</a></li>
<li class="toctree-l3"><a class="reference internal" href="#time-limited-background-operations">Time Limited Background Operations</a></li>
<li class="toctree-l3"><a class="reference internal" href="#gathering-facts">Gathering Facts</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="intro_configuration.html">Ansible的配置檔案</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro_windows.html">Windows Support</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">快速學習視訊</a></li>
<li class="toctree-l1"><a class="reference internal" href="playbooks.html">Playbooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="playbooks_special_topics.html">Playbooks: Special Topics</a></li>
<li class="toctree-l1"><a class="reference internal" href="modules.html">模組相關</a></li>
<li class="toctree-l1"><a class="reference internal" href="guides.html">詳細指南</a></li>
<li class="toctree-l1"><a class="reference internal" href="developing.html">開發者須知</a></li>
<li class="toctree-l1"><a class="reference internal" href="tower.html">Ansible Tower</a></li>
<li class="toctree-l1"><a class="reference internal" href="community.html">Ansible使用者</a></li>
<li class="toctree-l1"><a class="reference internal" href="community.html#id6">對當前和未來的開發人員</a></li>
<li class="toctree-l1"><a class="reference internal" href="community.html#id9">其它主題</a></li>
<li class="toctree-l1"><a class="reference internal" href="galaxy.html">Ansible Galaxy</a></li>
<li class="toctree-l1"><a class="reference internal" href="test_strategies.html">測試策略</a></li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">常見問題</a></li>
<li class="toctree-l1"><a class="reference internal" href="glossary.html">術語表</a></li>
<li class="toctree-l1"><a class="reference internal" href="YAMLSyntax.html">YAML 語法</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">ansible中文權威指南</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
          <li><a href="intro.html">總體介紹</a> &raquo;</li>
      
    <li>Introduction To Ad-Hoc Commands</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/intro_adhoc.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="introduction-to-ad-hoc-commands">
<h1><a class="toc-backref" href="#id7">Introduction To Ad-Hoc Commands</a><a class="headerlink" href="#introduction-to-ad-hoc-commands" title="Permalink to this headline">¶</a></h1>
<div class="contents topic" id="topics">
<p class="topic-title first">Topics</p>
<ul class="simple">
<li><a class="reference internal" href="#introduction-to-ad-hoc-commands" id="id7">Introduction To Ad-Hoc Commands</a><ul>
<li><a class="reference internal" href="#parallelism-and-shell-commands" id="id8">Parallelism and Shell Commands</a></li>
<li><a class="reference internal" href="#file-transfer" id="id9">File Transfer</a></li>
<li><a class="reference internal" href="#managing-packages" id="id10">Managing Packages</a></li>
<li><a class="reference internal" href="#users-and-groups" id="id11">Users and Groups</a></li>
<li><a class="reference internal" href="#deploying-from-source-control" id="id12">Deploying From Source Control</a></li>
<li><a class="reference internal" href="#managing-services" id="id13">Managing Services</a></li>
<li><a class="reference internal" href="#time-limited-background-operations" id="id14">Time Limited Background Operations</a></li>
<li><a class="reference internal" href="#gathering-facts" id="id15">Gathering Facts</a></li>
</ul>
</li>
</ul>
</div>
<p>在下面的例子中,我們將演示如何使用 <cite>/usr/bin/ansible</cite> 執行 ad hoc 任務.</p>
<p>所謂 ad-hoc 命令是什麼呢?</p>
<p>(這其實是一個概念性的名字,是相對於寫 Ansible playbook 來說的.類似於在命令列敲入shell命令和
寫shell scripts兩者之間的關係)...</p>
<p>如果我們敲入一些命令去比較快的完成一些事情,而不需要將這些執行的命令特別儲存下來,
這樣的命令就叫做 ad-hoc 命令.</p>
<p>Ansible提供兩種方式去完成任務,一是 ad-hoc 命令,一是寫 Ansible playbook.前者可以解決一些簡單的任務,
後者解決較複雜的任務.</p>
<p>一般而言,在學習了 playbooks 之後,你才能體會到 Ansible 真正的強大之處在哪裡.</p>
<p>那我們會在什麼情境下去使用ad-hoc 命令呢?</p>
<p>比如說因為聖誕節要來了,想要把所有實驗室的電源關閉,我們只需要執行一行命令
就可以達成這個任務,而不需要寫 playbook 來做這個任務.</p>
<p>至於說做配置管理或部署這種事,還是要藉助 playbook 來完成,即使用 &#8216;/usr/bin/ansible-playbook&#8217; 這個命令.</p>
<p>(關於 playbook 的使用,請參考  <a class="reference internal" href="playbooks.html"><em>Playbooks</em></a> )</p>
<p>如果你還沒有閱讀 <a class="reference internal" href="intro_inventory.html"><em>Inventory檔案</em></a> ,最好先看一看,然後我們繼續往下.</p>
<div class="section" id="parallelism-and-shell-commands">
<span id="id1"></span><h2><a class="toc-backref" href="#id8">Parallelism and Shell Commands</a><a class="headerlink" href="#parallelism-and-shell-commands" title="Permalink to this headline">¶</a></h2>
<p>舉一個例子</p>
<p>這裡我們要使用 Ansible 的命令列工具來重啟 Atlanta 組中所有的 web 伺服器,每次重啟10個.</p>
<p>我們先設定 SSH-agent,將私鑰納入其管理:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>ssh-agent bash
<span class="nv">$ </span>ssh-add ~/.ssh/id_rsa
</pre></div>
</div>
<p>如果不想使用 ssh-agent, 想通過密碼驗證的方式使用 SSH,可以在執行ansible命令時使用 <code class="docutils literal"><span class="pre">--ask-pass</span></code> (<code class="docutils literal"><span class="pre">-k</span></code>)選項,
但這裡建議使用 ssh-agent.</p>
<p>現在執行如下命令,這個命令中,atlanta是一個組,這個組裡面有很多伺服器,&#8221;/sbin/reboot&#8221;命令會在atlanta組下
的所有機器上執行.這裡ssh-agent會fork出10個子程序(bash),以並行的方式執行reboot命令.如前所說“每次重啟10個”
即是以這種方式實現:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>ansible atlanta -a <span class="s2">&quot;/sbin/reboot&quot;</span> -f 10
</pre></div>
</div>
<p>在執行 /usr/bin/ansible 時,預設是以當前使用者的身份去執行這個命令.如果想以指定的使用者執行 /usr/bin/ansible,
請新增 &#8220;-u username&#8221;選項,如下:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>ansible atlanta -a <span class="s2">&quot;/usr/bin/foo&quot;</span> -u username
</pre></div>
</div>
<p>如果想通過 sudo 去執行命令,如下:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>ansible atlanta -a <span class="s2">&quot;/usr/bin/foo&quot;</span> -u username --sudo <span class="o">[</span>--ask-sudo-pass<span class="o">]</span>
</pre></div>
</div>
<p>如果你不是以 passwordless 的模式執行 sudo,應加上 <code class="docutils literal"><span class="pre">--ask-sudo-pass</span></code> (<code class="docutils literal"><span class="pre">-K</span></code>)選項,加上之後會提示你輸入
密碼.使用 passwordless 模式的 sudo, 更容易實現自動化,但不要求一定要使用 passwordless sudo.</p>
<p>也可以通過``&#8211;sudo-user`` (<code class="docutils literal"><span class="pre">-U</span></code>)選項,使用 sudo 切換到其它使用者身份,而不是 root(譯者注:下面命令中好像寫掉了&#8211;sudo):</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>ansible atlanta -a <span class="s2">&quot;/usr/bin/foo&quot;</span> -u username -U otheruser <span class="o">[</span>--ask-sudo-pass<span class="o">]</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">在有些比較罕見的情況下,一些使用者會受到安全規則的限制,使用 sudo 切換時只能執行指定的命令.這與 ansible的 no-bootstrapping 思想相悖,而且 ansible 有幾百個模組,在這種限制下無法進行正常的工作.
所以執行 ansible 命令時,應使用一個沒有受到這種限制的賬號來執行.One way of doing this without sharing access to unauthorized users would be gating Ansible with <a class="reference internal" href="tower.html"><em>Ansible Tower</em></a>, which
can hold on to an SSH credential and let members of certain organizations use it on their behalf without having direct access.</p>
</div>
<p>以上是關於 ansible 的基礎.如果你還沒閱讀過 patterns 和 groups,應先閱讀 <a class="reference internal" href="intro_patterns.html"><em>Patterns</em></a> .</p>
<p>在前面寫出的命令中, <code class="docutils literal"><span class="pre">-f</span> <span class="pre">10</span></code> 選項表示使用10個並行的程序.這個選項也可以在 <a class="reference internal" href="intro_configuration.html"><em>Ansible的配置檔案</em></a> 中設定,
在配置檔案中指定的話,就不用在命令列中寫出了.這個選項的預設值是 5,是比較小的.如果同時操作的主機數比較多的話,
可以調整到一個更大的值,只要不超出你係統的承受範圍就沒問題.如果主機數大於設定的併發程序數,Ansible會自行協調,
花得時間會更長一點.</p>
<p>ansible有許多模組,預設是 &#8216;command&#8217;,也就是命令模組,我們可以通過 <code class="docutils literal"><span class="pre">-m</span></code> 選項來指定不同的模組.在前面所示的例子中,
因為我們是要在 Atlanta 組下的伺服器中執行 reboot 命令,所以就不需要顯示的用這個選項指定 &#8216;command&#8217; 模組,使用
預設設定就OK了.一會在其他例子中,我們會使用 <code class="docutils literal"><span class="pre">-m</span></code> 執行其他的模組,詳情參見 <a class="reference internal" href="modules.html"><em>模組相關</em></a> .</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><span class="xref std std-ref">command</span> 模組不支援 shell 變數,也不支援管道等 shell 相關的東西.如果你想使用 shell相關的這些東西, 請使用&#8217;shell&#8217; 模組.兩個模組之前的差別請參考 <a class="reference internal" href="modules.html"><em>模組相關</em></a> .</p>
</div>
<p>使用 <span class="xref std std-ref">shell</span> 模組的示例如下:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>ansible raleigh -m shell -a <span class="s1">&#39;echo $TERM&#39;</span>
</pre></div>
</div>
<p>使用 Ansible <em>ad hoc</em> 命令列介面時(與使用 <a class="reference internal" href="playbooks.html"><em>Playbooks</em></a> 的情況相反),尤其注意 shell 引號的規則.
比如在上面的例子中,如果使用雙引號&#8221;echo $TERM&#8221;,會求出TERM變數在當前系統的值,而我們實際希望的是把這個命令傳遞
到其它機器執行.</p>
<p>在此我們已經演示了一些簡單命令如何去執行,但通常來講大多數 Ansible 模組的工作方式與簡單的指令碼不同.They make the remote
system look like you state, and run the commands necessary to get it there.這一般被稱為 &#8216;idempotence&#8217;,
是 Ansible 設計的核心目標.但我們也認識到,能執行任意命令也是重要的,所以 Ansible 對這兩者都做支援.</p>
</div>
<div class="section" id="file-transfer">
<span id="id2"></span><h2><a class="toc-backref" href="#id9">File Transfer</a><a class="headerlink" href="#file-transfer" title="Permalink to this headline">¶</a></h2>
<p>這是 <cite>/usr/bin/ansible</cite> 的另一種用法.Ansible 能夠以並行的方式同時 SCP 大量的檔案到多臺機器.
命令如下:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>ansible atlanta -m copy -a <span class="s2">&quot;src=/etc/hosts dest=/tmp/hosts&quot;</span>
</pre></div>
</div>
<p>若你使用 playbooks, 則可以利用 <code class="docutils literal"><span class="pre">template</span></code> 模組來做到更進一步的事情.(請參見 module 和 playbook 的文件)</p>
<p>使用 <code class="docutils literal"><span class="pre">file</span></code> 模組可以做到修改檔案的屬主和許可權,(在這裡可替換為 <code class="docutils literal"><span class="pre">copy</span></code> 模組,是等效的):</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>ansible webservers -m file -a <span class="s2">&quot;dest=/srv/foo/a.txt mode=600&quot;</span>
<span class="nv">$ </span>ansible webservers -m file -a <span class="s2">&quot;dest=/srv/foo/b.txt mode=600 owner=mdehaan group=mdehaan&quot;</span>
</pre></div>
</div>
<p>使用 <code class="docutils literal"><span class="pre">file</span></code> 模組也可以建立目錄,與執行 <code class="docutils literal"><span class="pre">mkdir</span> <span class="pre">-p</span></code> 效果類似:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>ansible webservers -m file -a <span class="s2">&quot;dest=/path/to/c mode=755 owner=mdehaan group=mdehaan state=directory&quot;</span>
</pre></div>
</div>
<p>刪除目錄(遞迴的刪除)和刪除檔案:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>ansible webservers -m file -a <span class="s2">&quot;dest=/path/to/c state=absent&quot;</span>
</pre></div>
</div>
</div>
<div class="section" id="managing-packages">
<span id="id3"></span><h2><a class="toc-backref" href="#id10">Managing Packages</a><a class="headerlink" href="#managing-packages" title="Permalink to this headline">¶</a></h2>
<p>Ansible 提供對 yum 和 apt 的支援.這裡是關於 yum 的示例.</p>
<p>確認一個軟體包已經安裝,但不去升級它:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>ansible webservers -m yum -a <span class="s2">&quot;name=acme state=present&quot;</span>
</pre></div>
</div>
<p>確認一個軟體包的安裝版本:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>ansible webservers -m yum -a <span class="s2">&quot;name=acme-1.5 state=present&quot;</span>
</pre></div>
</div>
<p>確認一個軟體包還沒有安裝:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>ansible webservers -m yum -a <span class="s2">&quot;name=acme state=absent&quot;</span>
</pre></div>
</div>
<p>對於不同平臺的軟體包管理工具,Ansible都有對應的模組.如果沒有,你也可以使用 command 模組去安裝軟體.
或者最好是來為那個軟體包管理工具貢獻一個相應的模組.請在 mailing list 中檢視相關的資訊和詳情.</p>
</div>
<div class="section" id="users-and-groups">
<span id="id4"></span><h2><a class="toc-backref" href="#id11">Users and Groups</a><a class="headerlink" href="#users-and-groups" title="Permalink to this headline">¶</a></h2>
<p>使用 &#8216;user&#8217; 模組可以方便的建立賬戶,刪除賬戶,或是管理現有的賬戶:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>ansible all -m user -a <span class="s2">&quot;name=foo password=&lt;crypted password here&gt;&quot;</span>

<span class="nv">$ </span>ansible all -m user -a <span class="s2">&quot;name=foo state=absent&quot;</span>
</pre></div>
</div>
<p>更多可用的選項請參考 <a class="reference internal" href="modules.html"><em>模組相關</em></a> ,包括對組和組成員關係的操作.</p>
</div>
<div class="section" id="deploying-from-source-control">
<span id="from-source-control"></span><h2><a class="toc-backref" href="#id12">Deploying From Source Control</a><a class="headerlink" href="#deploying-from-source-control" title="Permalink to this headline">¶</a></h2>
<p>直接使用 git 部署 webapp:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>ansible webservers -m git -a <span class="s2">&quot;repo=git://foo.example.org/repo.git dest=/srv/myapp version=HEAD&quot;</span>
</pre></div>
</div>
<p>因為Ansible 模組可通知到 change handlers ,所以當源碼被更新時,我們可以告知 Ansible 這個資訊,並執行指定的任務,
比如直接通過 git 部署 Perl/Python/PHP/Ruby, 部署完成後重啟 apache.</p>
</div>
<div class="section" id="managing-services">
<span id="id5"></span><h2><a class="toc-backref" href="#id13">Managing Services</a><a class="headerlink" href="#managing-services" title="Permalink to this headline">¶</a></h2>
<p>確認某個服務在所有的webservers上都已經啟動:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>ansible webservers -m service -a <span class="s2">&quot;name=httpd state=started&quot;</span>
</pre></div>
</div>
<p>或是在所有的webservers上重啟某個服務(譯者注:可能是確認已重啟的狀態?):</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>ansible webservers -m service -a <span class="s2">&quot;name=httpd state=restarted&quot;</span>
</pre></div>
</div>
<p>確認某個服務已經停止:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>ansible webservers -m service -a <span class="s2">&quot;name=httpd state=stopped&quot;</span>
</pre></div>
</div>
</div>
<div class="section" id="time-limited-background-operations">
<span id="id6"></span><h2><a class="toc-backref" href="#id14">Time Limited Background Operations</a><a class="headerlink" href="#time-limited-background-operations" title="Permalink to this headline">¶</a></h2>
<p>需要長時間執行的命令可以放到後臺去,在命令開始執行後我們也可以檢查執行的狀態.如果執行命令後,不想獲取返回的資訊,
可執行如下命令:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>ansible all -B <span class="m">3600</span> -P <span class="m">0</span> -a <span class="s2">&quot;/usr/bin/long_running_operation --do-stuff&quot;</span>
</pre></div>
</div>
<p>如果你確定要在命令執行後檢查執行的狀態,可以使用 async_status 模組.前面執行後臺命令後會返回一個 job id,
將這個 id 傳給 async_status 模組:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>ansible web1.example.com -m async_status -a <span class="s2">&quot;jid=488359678239.2844&quot;</span>
</pre></div>
</div>
<p>獲取狀態的命令如下:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>ansible all -B <span class="m">1800</span> -P <span class="m">60</span> -a <span class="s2">&quot;/usr/bin/long_running_operation --do-stuff&quot;</span>
</pre></div>
</div>
<p>其中 <code class="docutils literal"><span class="pre">-B</span> <span class="pre">1800</span></code> 表示最多執行30分鐘, <code class="docutils literal"><span class="pre">-P</span> <span class="pre">60</span></code> 表示每隔60秒獲取一次狀態資訊.</p>
<p>Polling 獲取狀態資訊的操作會在後臺工作任務啟動之後開始.若你希望所有的工作任務快速啟動, <code class="docutils literal"><span class="pre">--forks</span></code> 這個選項的值
要設定得足夠大,這是前面講過的併發程序的個數.在執行指定的時間(由``-B``選項所指定)後,遠端節點上的任務程序便會被終止.</p>
<p>一般你只能在把需要長時間執行的命令或是軟體升級這樣的任務放到後臺去執行.對於 copy 模組來說,即使按照前面的示例想放到
後臺執行檔案傳輸,實際上並不會如你所願.</p>
</div>
<div class="section" id="gathering-facts">
<span id="checking-facts"></span><h2><a class="toc-backref" href="#id15">Gathering Facts</a><a class="headerlink" href="#gathering-facts" title="Permalink to this headline">¶</a></h2>
<p>在 playbooks 中有對於 Facts 做描述,它代表的是一個系統中已發現的變數.These can be used to implement conditional execution
of tasks but also just to get ad-hoc information about your system. 可通過如下方式檢視所有的 facts:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>ansible all -m setup
</pre></div>
</div>
<p>我們也可以對這個命令的輸出做過濾,只輸出特定的一些 facts,詳情請參考 &#8220;setup&#8221; 模組的文件.</p>
<p>如果你已準備好仔細研究 <a class="reference internal" href="playbooks.html"><em>Playbooks</em></a> ,可以繼續讀讀 <a class="reference internal" href="playbooks_variables.html"><em>Variables</em></a> ,會對 facts有更多瞭解.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="intro_configuration.html"><em>Ansible的配置檔案</em></a></dt>
<dd>All about the Ansible config file</dd>
<dt><a class="reference internal" href="modules.html"><em>模組相關</em></a></dt>
<dd>A list of available modules</dd>
<dt><a class="reference internal" href="playbooks.html"><em>Playbooks</em></a></dt>
<dd>Using Ansible for configuration management &amp; deployment</dd>
<dt><a class="reference external" href="http://groups.google.com/group/ansible-project">Mailing List</a></dt>
<dd>Questions? Help? Ideas?  Stop by the list on Google Groups</dd>
<dt><a class="reference external" href="http://irc.freenode.net">irc.freenode.net</a></dt>
<dd>#ansible IRC chat channel</dd>
</dl>
</div>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="intro_configuration.html" class="btn btn-neutral float-right" title="Ansible的配置檔案" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="intro_patterns.html" class="btn btn-neutral" title="Patterns" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015, www.magedu.com, AUTHORS: 薛定諤的章魚 &amp; guli &amp; 以馬內利 &amp; 黃博文 &amp; coocla &amp; 雲中鶴 &amp; stanley.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'1.0.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="static/jquery.js"></script>
      <script type="text/javascript" src="static/underscore.js"></script>
      <script type="text/javascript" src="static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>
